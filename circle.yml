machine:
  node:
    version: v6.1.0
  python:
    version: 2.7.11
checkout:
  post:
    - git submodule sync --recursive
    - git submodule update --init
dependencies:
  pre:
    - npm install -g browserify
  override:
    - npm install:
        pwd: ckanext/ckanext-sixodp_ui
general:
  branches:
    only:
      - setup-unit-tests
  artifacts:
    - "~/ckanext-sixodp_ui.tar.gz"
deployment:
  master:
    branch: master
    commands:
       - tar --exclude=".git ckanext/ckanext/sixodp_ui/node_modules" -czvf ~/ckanext-sixodp_ui.tar.gz ckanext/ckanext-sixodp_ui