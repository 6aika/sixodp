machine:
  node:
    version: v6.1.0
  python:
    version: 2.7.11
checkout:
  post:
    - git submodule sync --recursive
    - git submodule update --init
dependencies:
  pre:
    - sudo add-apt-repository -y ppa:ansible/ansible
    - sudo apt-get update
    - sudo apt-get install -y ansible
    - npm install -g browserify
  override:
    - npm install:
        pwd: ckanext/ckanext-sixodp_ui
compile:
  override:
    - sudo -u postgres psql -c "CREATE ROLE ckan_admin NOSUPERUSER CREATEDB CREATEROLE INHERIT LOGIN PASSWORD 'admin';"
    - cd ansible && ansible-playbook -i inventories/build build.yml
test:
  override: []
